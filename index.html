<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Work From Anywhere</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 900px;
      margin: 40px auto;
      padding: 0 20px;
      line-height: 1.6;
      background: #f9f9f9;
      color: #333;
    }
    h1 {
      text-align: center;
      margin-bottom: 40px;
    }
    .post {
      background: white;
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 20px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }
    .post:hover {
      transform: translateY(-3px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }
    .post h2 {
      margin: 0 0 10px;
      font-size: 1.3em;
    }
    .post a {
      text-decoration: none;
      color: #0077cc;
    }
    .post a:hover {
      text-decoration: underline;
    }
    .date {
      color: #888;
      font-size: 0.9em;
      margin-top: 5px;
    }
    .gallery-title {
      margin-top: 60px;
      font-size: 1.4em;
      font-weight: bold;
      text-align: center;
    }
    #gallery {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
      gap: 10px;
      margin-top: 20px;
    }
    #gallery img {
      width: 100%;
      border-radius: 10px;
      transition: transform 0.2s ease;
      cursor: pointer;
    }
    #gallery img:hover {
      transform: scale(1.05);
    }
  </style>
</head>
<body>
  <h1>Work From Anywhere</h1>

  <div id="posts">Loading posts...</div>

  <div class="gallery-title">Image Gallery</div>
  <div id="gallery">Loading images...</div>

  <script>
    const postsDiv = document.getElementById('posts');
    const galleryDiv = document.getElementById('gallery');

    // --- Temporary fallbacks before JSON exists ---
    const fallbackPosts = [
      {
        title: "üèÉ‚Äç‚ôÄÔ∏è Boost Your Online Earnings: Get +10% Bonus",
        excerpt: "<p>Boost your earnings with JumpTask tasks!</p>",
        path: "/Posts/boost-your-online-learming/index.html"
      }
    ];

    const fallbackImages = [
      "Images/example1.jpg",
      "Images/example2.webp",
      "Images/example3.png"
    ];

    // --- Helper functions ---
    function makeURL(path) {
      try { return new URL(path, location.href).href; } catch(e) { return path; }
    }

    function buildPostHTML(post) {
      const title = post.title || "Untitled Post";
      const excerpt = post.excerpt || "";
      const date = post.date ? `<div class="date">${new Date(post.date).toLocaleDateString()}</div>` : '';
      const link = post.source ? makeURL(post.source) : post.path ? makeURL(post.path) : "#";
      const image = post.image ? `<img src="${makeURL(post.image)}" alt="${title}" style="max-width:100%; border-radius:8px; margin-bottom:10px;">` : '';
      return `
        <div class="post">
          ${image}
          <h2><a href="${link}" target="_blank" rel="noopener noreferrer">${title}</a></h2>
          <div>${excerpt}</div>
          ${date}
        </div>
      `;
    }

    function buildGalleryHTML(images) {
      return images.map(img => {
        const src = img.src || img.path || img.url || img;
        return `<a href="${makeURL(src)}" target="_blank" rel="noopener noreferrer"><img src="${makeURL(src)}" alt=""></a>`;
      }).join('');
    }

    // --- Load posts ---
    async function loadPosts() {
      try {
        const res = await fetch('index.json', {cache: 'no-cache'});
        if (!res.ok) throw new Error("index.json not found");
        const posts = await res.json();
        if (!Array.isArray(posts) || !posts.length) throw new Error("index.json empty");
        postsDiv.innerHTML = posts.map(buildPostHTML).join('');
      } catch(e) {
        postsDiv.innerHTML = fallbackPosts.map(buildPostHTML).join('');
        console.warn("Using fallback posts:", e);
      }
    }

    // --- Load gallery images ---
    async function loadGallery() {
      try {
        const res = await fetch('images.json', {cache: 'no-cache'});
        if (!res.ok) throw new Error("images.json not found");
        const images = await res.json();
        if (!Array.isArray(images) || !images.length) throw new Error("images.json empty");
        galleryDiv.innerHTML = buildGalleryHTML(images);
      } catch(e) {
        galleryDiv.innerHTML = buildGalleryHTML(fallbackImages);
        console.warn("Using fallback images:", e);
      }
    }

    loadPosts();
    loadGallery();
  </script>
</body>
  </html>
